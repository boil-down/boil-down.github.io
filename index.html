<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>boildown reader</title>
	<link rel="stylesheet" href="reader.css">	
  </head>
  <body id="bdBody">
	<input type="text" id="bdURL" onkeypress="if (event.keyCode === 13) { show(); }" />
	<article id="bdDocument">

	</article>
	<script src="/boildown.js"></script>
	<script src="/reader.js"></script>
    <script>
	function show(url) {
		if (!url) {
			url = document.getElementById('bdURL').value;
		}
		if (!url) {
			url = window.location.hostname.indexOf(".github.io") > 0 
				? "https://raw.githubusercontent.com/boil-down/boildown.js/master/user-manual.bd" 
				: "/user-manual.bd";
		}
		var e = document.getElementById('bdDocument');
		bdReader.open(url, function(markup) {
			var start = new Date().getTime();
			var html = Boildown.toHTML(markup);
			var parsed = new Date().getTime();
			e.innerHTML=html;
			var end = new Date().getTime();
			if (console && console.log) {
				console.log("took "+(parsed-start)+"ms to parse, "+(end-parsed)+"ms to render");
			}
			document.getElementById('bdURL').value=url;
		}, function(status) {
			e.innerHTML="Failed to laod document <code>"+url+"</code>: "+status;
		}
		);
	}
	var url = /[&?]url=([^&]+)/.exec(window.location.search);
	if (url && url[1]) { url=decodeURIComponent(url[1]); }
	show(url);
	</script>
  </body>
</html>
